EPIC Earth Bot - Architecture & Plan
=====================================

Purpose:
  Automatically create and upload daily NASA EPIC Earth time-lapse
  videos to YouTube. Designed to be run once daily, with robust
  tracking to handle missed days without duplicating work.

Repository Structure:
  .
  ├── main.py                     # Orchestrator - runs the full pipeline
  ├── bootstrap.py                # One-time migration: seeds tracking from existing videos
  ├── requirements.txt            # Python dependencies
  ├── .env                        # NASA_API_KEY (gitignored)
  ├── .gitignore
  ├── data/
  │   └── tracking.json           # Per-date state: video created, uploaded, IDs
  ├── output/                     # Generated MP4 videos (epic_earth_YYYY-MM-DD.mp4)
  ├── utils/
  │   ├── __init__.py
  │   ├── nasa_api.py             # NASA EPIC API client (fetch dates, metadata, images)
  │   ├── video_engine.py         # FFmpeg 9:16 video creation with date overlay
  │   ├── tracking.py             # JSON-based state tracking system
  │   └── youtube_upload.py       # YouTube Data API v3 upload with OAuth2
  └── Youtube/
      ├── client_secrets.json     # OAuth2 client credentials (from Google Cloud Console)
      └── oauth_token.json        # Auto-generated OAuth token (gitignored)

Daily Run Workflow (main.py):
  1. Fetch available EPIC dates from the last 14 days
  2. Compare against tracking.json to find dates needing video creation
  3. For each missing date:
     a. Download EPIC frames from NASA API
     b. Create 9:16 (1080x1920) video with date overlay via FFmpeg
     c. Record in tracking.json
  4. Authenticate with YouTube (OAuth2, token cached)
  5. Compare against YouTube channel uploads + tracking to find unuploaded videos
  6. Upload missing videos with proper metadata (title, description, tags)
  7. Update tracking.json with YouTube video IDs
  8. Clean up tracking entries older than 30 days

Anti-Duplication Strategy:
  - tracking.json records video_created + video_path per date
  - is_video_created() also checks the file exists on disk
  - Before uploading, existing YouTube uploads are fetched and cross-checked
  - Consistent title format enables duplicate detection on YouTube side
  - Even if tracking.json is lost, YouTube check prevents re-uploads

First Run:
  1. pip install -r requirements.txt
  2. Ensure .env has NASA_API_KEY
  3. Ensure Youtube/client_secrets.json is configured
  4. python bootstrap.py  (seeds tracking for any existing videos)
  5. python main.py       (creates missing videos + uploads)
  6. First run opens browser for YouTube OAuth consent

Subsequent Runs:
  python main.py
  (Everything is automatic - skips completed work, processes only new dates)
